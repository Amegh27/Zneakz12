<style>
a.btn:hover {
  background-color: #111 !important;
  color: #fff !important;
  transform: scale(1.05);
}

/* Enhanced navbar styling with modern gradient and better shadows */
.navbar {
  background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%) !important;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08) !important;
  border-bottom: 1px solid rgba(0, 0, 0, 0.05);
}

/* Improved announcement bar with gradient and better typography */
.navbar-top {
  background: linear-gradient(90deg, #1a1a1a 0%, #2d2d2d 100%) !important;
  font-weight: 500;
  letter-spacing: 0.8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
}

.navbar-top a {
  font-weight: 600;
  transition: all 0.3s ease;
}

.navbar-top a:hover {
  opacity: 0.8;
  text-decoration: none !important;
}

/* Enhanced search form with better focus states and styling */
.search-form {
  background: linear-gradient(135deg, #f5f5f5 0%, #ffffff 100%) !important;
  border: 2px solid #e0e0e0 !important;
  transition: all 0.3s ease;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
}

.search-form:focus-within {
  border-color: #000 !important;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.12);
  transform: translateY(-2px);
}

.search-form input::placeholder {
  color: #999;
  font-weight: 500;
}

.search-form input:focus {
  outline: none;
  color: #000;
}

/* Improved nav links with underline animation */
.nav-link {
  font-weight: 600;
  font-size: 0.95rem;
  letter-spacing: 0.5px;
  color: #1a1a1a !important;
  position: relative;
  transition: color 0.3s ease;
  text-transform: uppercase;
}

.nav-link::after {
  content: '';
  position: absolute;
  bottom: -4px;
  left: 0;
  width: 0;
  height: 2px;
  background: #000;
  transition: width 0.3s ease;
}

.nav-link:hover {
  color: #000 !important;
}

.nav-link:hover::after {
  width: 100%;
}

/* Enhanced brand logo with better styling */
.navbar-brand {
  font-family: 'Orbitron', sans-serif !important;
  font-size: 1.8rem !important;
  letter-spacing: 3px !important;
  color: #000 !important;
  font-weight: 800 !important;
  transition: all 0.3s ease;
  text-transform: uppercase;
}

.navbar-brand:hover {
  transform: scale(1.05);
  letter-spacing: 5px;
}

/* Improved icon styling with hover effects */
.navbar a i {
  transition: all 0.3s ease;
  color: #1a1a1a;
}

.navbar a:hover i {
  color: #000;
  transform: scale(1.15);
}

/* Enhanced button styling with better states */
.btn-outline-dark {
  border: 2px solid #000 !important;
  color: #000 !important;
  font-weight: 600;
  letter-spacing: 0.5px;
  transition: all 0.3s ease;
  border-radius: 50px !important;
}

.btn-outline-dark:hover {
  background-color: #000 !important;
  color: #fff !important;
  transform: translateY(-2px);
  box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
}

/* Improved dropdown styling */
.dropdown-menu {
  border: 1px solid #e0e0e0;
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
  animation: slideDown 0.2s ease;
}

@keyframes slideDown {
  from {
    opacity: 0;
    transform: translateY(-8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.dropdown-item {
  font-weight: 500;
  transition: all 0.2s ease;
  color: #1a1a1a;
}

.dropdown-item:hover {
  background-color: #f5f5f5;
  color: #000;
  padding-left: 1.5rem;
}

.dropdown-item.text-danger:hover {
  background-color: #ffe0e0;
  color: #d32f2f;
}

/* Enhanced search button styling */
.btn-dark {
  background-color: #000 !important;
  border: none !important;
  transition: all 0.3s ease;
}

.btn-dark:hover {
  background-color: #1a1a1a !important;
  transform: scale(1.1);
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

/* Improved cart badge styling */
#cartCount {
  background-color: #d32f2f !important;
  font-weight: 700;
  font-size: 0.75rem;
  animation: pulse 2s infinite;
}

@keyframes pulse {
  0%, 100% {
    transform: scale(1);
  }
  50% {
    transform: scale(1.1);
  }
}

/* Better responsive spacing */
@media (max-width: 991px) {
  .navbar-brand {
    font-size: 1.5rem !important;
    letter-spacing: 2px !important;
  }
  
  .nav-link {
    font-size: 0.9rem;
    padding: 0.5rem 0 !important;
  }
}
</style>

<!-- Top Announcement Bar -->
<div class="navbar-top text-center py-3 text-white" style="background-color: #000000; font-size: 14px; letter-spacing: 0.5px;">
  Summer Sale And Free Express Delivery - OFF 50%!
  <a href="/product-details?id=68f078136bcd87fad1c86075" class="text-warning text-decoration-underline">Shop Now by ZNEAKZ</a>
</div>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg bg-white shadow-sm">
  <div class="container">
<a class="navbar-brand" href="/" 
  style="
    font-family: 'Orbitron', sans-serif;
    font-size: 2rem;
    letter-spacing: 4px;
    color: #0f0f0f;
    text-transform: uppercase;
    font-weight: 700;
    padding-bottom: 2px;
  ">
  ZNEAKZ
</a>

    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="/men">MEN</a></li>
        <li class="nav-item"><a class="nav-link" href="/women">WOMEN</a></li>
        <li class="nav-item"><a class="nav-link" href="/kids">KIDS</a></li>
      </ul>

      <!-- Search Form -->
   <form class="d-flex align-items-center search-form px-3 py-2 rounded-pill"
      action="/#productSection" method="GET"
      style="max-width: 480px;">
  
  <!-- Search input -->
  <input class="form-control border-0 shadow-none me-2"
         type="search"
         name="q"
         placeholder="Search sneakers"
         value="<%= typeof query !== 'undefined' ? query : '' %>"
         style="font-size: 0.95rem; flex: 1; background: transparent;">
  
  <select class="form-select border-0 bg-transparent me-2 text-muted"
        name="sort"
        onchange="
          const params = new URLSearchParams(window.location.search);
          params.set('sort', this.value);
          window.location.search = params.toString() + '#productSection';
        "
        style="font-size: 0.9rem; width: 150px;">
    <option value="">Sort</option>
    <option value="priceAsc" <%= sort==='priceAsc' ? 'selected' : '' %>>Price: Low → High</option>
    <option value="priceDesc" <%= sort==='priceDesc' ? 'selected' : '' %>>Price: High → Low</option>
    <option value="nameAsc" <%= sort==='nameAsc' ? 'selected' : '' %>>Name: A–Z</option>
    <option value="nameDesc" <%= sort==='nameDesc' ? 'selected' : '' %>>Name: Z–A</option>
</select>

  
  <!-- Search button -->
  <button class="btn btn-dark rounded-circle d-flex align-items-center justify-content-center"
          type="submit"
          style="width: 38px; height: 38px;">
    <i class="bi bi-search"></i>
  </button>

  <!-- Clear button -->
  <% if (typeof query !== 'undefined' && query.trim() !== '') { %>
    <a href="/" class="btn btn-outline-secondary ms-2 rounded-circle d-flex align-items-center justify-content-center"
       style="width: 38px; height: 38px;">
      <i class="bi bi-x-lg"></i>
    </a>
  <% } %>
</form>


      <!-- Wishlist + Cart -->
<a href="/wishlist" title="Wishlist" class="position-relative">
  <i class="bi bi-heart fs-5"></i>
  <span id="wishlistCount" class="position-absolute badge rounded-pill bg-danger" 
        style="top:-5px; right:-10px; display:none;">0</span>
</a>
      <a href="/cart" class="position-relative ms-3 me-4">
        <i class="bi bi-cart fs-5"></i>
        <span id="cartCount" class="position-absolute badge rounded-pill bg-danger">0</span>
      </a>

      <% if (typeof user !== 'undefined' && user) { %>
        <div class="dropdown">
          <a style="color: #000;" class="d-flex align-items-center text-decoration-none dropdown-toggle" href="#" role="button"
            id="userDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            <span style="color: #000;"><%= user.name %></span>
          </a>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
            <li><a class="dropdown-item" href="/profile">Profile</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item text-danger" href="#" onclick="confirmLogout(event)">Logout</a></li>
          </ul>
        </div>
      <% } else { %>
        <a href="/signup" 
   class="btn btn-outline-dark me-2 fw-semibold"
   style="border-radius: 50px; padding: 8px 22px; transition: all 0.3s;">
  Sign Up
</a>
<a href="/login" 
   class="btn btn-outline-dark fw-semibold"
   style="border-radius: 50px; padding: 8px 22px; transition: all 0.3s;">
  Log In
</a>
      <% } %>
    </div>
  </div>
</nav>

<!-- SweetAlert2 Logout Script -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script>
  function confirmLogout(event) {
    event.preventDefault();
    Swal.fire({
      title: 'Are you sure?',
      text: "You will be logged out of your account.",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#d33',
      cancelButtonColor: '#6c757d',
      confirmButtonText: 'Yes, Logout',
      cancelButtonText: 'Cancel'
    }).then((result) => {
      if (result.isConfirmed) {
        window.location.href = '/logout';
      }
    });
  }

  async function updateCartCount() {
      try {
        const res = await fetch("/cart/count");
        const text = await res.text();

        let data;
        try {
          data = JSON.parse(text);
        } catch {
          console.warn("Unexpected /cart/count response:", text);
          return;
        }

        const cartCountEl = document.getElementById("cartCount");
        const count = data.count || 0;

        if (cartCountEl) {
          cartCountEl.textContent = count;
          cartCountEl.style.display = count > 0 ? "inline-block" : "none";
        }
      } catch (err) {
        console.error("Error updating cart count:", err);
      }
    }

    document.addEventListener("DOMContentLoaded", updateCartCount);

    async function addToCart(productId, size, quantity) {
      try {
        const res = await fetch("/cart/add", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ productId, size, quantity }),
        });

        const data = await res.json();

        if (data.success) {
          const cartCountEl = document.getElementById("cartCount");
          const count = data.cartCount || 0;
          if (cartCountEl) {
            cartCountEl.textContent = count;
            cartCountEl.style.display = count > 0 ? "inline-block" : "none";
          }

          Swal.fire({
            icon: "success",
            title: "Added to Cart",
            text: data.message || "Item added successfully!",
            timer: 1200,
            toast: true,
            position: "top-end",
            showConfirmButton: false,
          });

          updateCartCount();
        } else if (data.redirect) {
          window.location.href = data.redirect;
        } else {
          Swal.fire({
            icon: "error",
            title: "Error",
            text: data.message || "Failed to add to cart",
            timer: 1500,
            toast: true,
            position: "top-end",
            showConfirmButton: false,
          });
        }
      } catch (err) {
        console.error("Add to cart failed:", err);
        Swal.fire({
          icon: "error",
          title: "Server Error",
          text: "Please try again later",
          timer: 1500,
          toast: true,
          position: "top-end",
          showConfirmButton: false,
        });
      }
    }

    async function updateWishlistCount() {
    try {
      const res = await fetch("/wishlist/count");
      const dataText = await res.text();

      let data;
      try {
        data = JSON.parse(dataText);
      } catch {
        console.warn("Unexpected /wishlist/count response:", dataText);
        return;
      }

      const countEl = document.getElementById("wishlistCount");
      const count = data.count || 0;

      if (countEl) {
        countEl.textContent = count;
        countEl.style.display = count > 0 ? "inline-block" : "none";
      }
    } catch (err) {
      console.error("Error updating wishlist count:", err);
    }
  }

  document.addEventListener("DOMContentLoaded", () => {
    updateCartCount();
    updateWishlistCount();  
  });
</script>
